# Staging Environment Configuration Template
# Copy this file to .env.staging and fill in the actual values

# ====================================
# NODE ENVIRONMENT
# ====================================
NODE_ENV=staging

# ====================================
# SERVER CONFIGURATION
# ====================================
PORT=3001
HOST=0.0.0.0

# ====================================
# DATABASE CONFIGURATION
# ====================================
DATABASE_URL="postgresql://username:password@hostname:5432/cosnap_staging?schema=public&sslmode=require&connection_limit=10&pool_timeout=20"

# Database Connection Pool Settings
DB_CONNECTION_LIMIT=10
DB_POOL_TIMEOUT=20000
DB_IDLE_TIMEOUT=10000

# ====================================
# JWT AUTHENTICATION
# ====================================
JWT_SECRET="your-256-bit-secret-key-staging"
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET="your-refresh-token-secret-staging"
JWT_REFRESH_EXPIRES_IN=30d

# ====================================
# CORS CONFIGURATION
# ====================================
ALLOWED_ORIGINS="https://staging.cosnap.ai,https://cosnap-staging.vercel.app"

# ====================================
# RUNNINGHUB API CONFIGURATION
# ====================================
RUNNINGHUB_API_KEY_CHINA="your-staging-china-api-key"
RUNNINGHUB_API_KEY_HONGKONG="your-staging-hongkong-api-key"
RUNNINGHUB_BASE_URL_CHINA="https://www.runninghub.cn/api"
RUNNINGHUB_BASE_URL_HONGKONG="https://api.runninghub.cn/api"

# API Rate Limiting
RUNNINGHUB_RATE_LIMIT=50
RUNNINGHUB_TIMEOUT=60000

# ====================================
# ALIBABA CLOUD OSS CONFIGURATION
# ====================================
ALI_OSS_REGION="oss-cn-beijing"
ALI_OSS_ACCESS_KEY_ID="your-staging-oss-access-key-id"
ALI_OSS_ACCESS_KEY_SECRET="your-staging-oss-access-key-secret"
ALI_OSS_BUCKET="cosnap-staging"
ALI_OSS_ENDPOINT="https://oss-cn-beijing.aliyuncs.com"

# ====================================
# REDIS CONFIGURATION
# ====================================
REDIS_URL="redis://username:password@hostname:6379"
REDIS_PASSWORD="your-redis-password"
REDIS_DB=1
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY_ON_FAILURE=100

# ====================================
# PAYMENT CONFIGURATION (Sandbox)
# ====================================
# WeChat Pay Sandbox
WECHAT_APP_ID="your-wechat-sandbox-app-id"
WECHAT_MCH_ID="your-sandbox-merchant-id"
WECHAT_API_KEY="your-wechat-sandbox-api-key"
WECHAT_CERT_PATH="/path/to/wechat/sandbox-cert.pem"
WECHAT_KEY_PATH="/path/to/wechat/sandbox-key.pem"

# Alipay Sandbox
ALIPAY_APP_ID="your-alipay-sandbox-app-id"
ALIPAY_PRIVATE_KEY="your-alipay-sandbox-private-key"
ALIPAY_PUBLIC_KEY="your-alipay-sandbox-public-key"
ALIPAY_GATEWAY="https://openapi.alipaydev.com/gateway.do"

# ====================================
# MONITORING & LOGGING
# ====================================
# APM Configuration
APM_SERVICE_NAME="cosnap-backend-staging"
APM_ENVIRONMENT="staging"
APM_SERVER_URL="https://your-apm-server.com"
APM_SECRET_TOKEN="your-apm-secret-token"

# Logging Configuration
LOG_LEVEL="debug"
LOG_FORMAT="json"
LOG_FILE_PATH="/var/log/cosnap/staging-app.log"
LOG_MAX_SIZE="10m"
LOG_MAX_FILES="7"

# Error Tracking (Sentry)
SENTRY_DSN="https://your-sentry-dsn@sentry.io/staging-project-id"
SENTRY_ENVIRONMENT="staging"
SENTRY_RELEASE="staging-latest"

# ====================================
# SECURITY CONFIGURATION
# ====================================
# Rate Limiting (More lenient for testing)
RATE_LIMIT_MAX=200
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# Security Headers
HSTS_MAX_AGE=31536000
CSP_POLICY="default-src 'self'; img-src 'self' https:; script-src 'self' 'unsafe-eval'"

# Session Security
SESSION_SECRET="your-staging-session-secret"
COOKIE_SECURE=true
COOKIE_HTTP_ONLY=true
COOKIE_SAME_SITE="strict"

# ====================================
# FILE UPLOAD CONFIGURATION
# ====================================
MAX_FILE_SIZE=31457280
ALLOWED_FILE_TYPES="image/jpeg,image/png,image/gif,image/webp"
UPLOAD_TIMEOUT=30000

# ====================================
# CACHE CONFIGURATION
# ====================================
CACHE_TTL=300
CACHE_MAX_SIZE=500
CACHE_PREFIX="cosnap-staging:"

# ====================================
# HEALTH CHECK CONFIGURATION
# ====================================
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_INTERVAL=30000

# ====================================
# BACKUP CONFIGURATION
# ====================================
BACKUP_SCHEDULE="0 3 * * *"
BACKUP_RETENTION_DAYS=7
BACKUP_S3_BUCKET="cosnap-staging-backups"
BACKUP_S3_REGION="us-east-1"

# ====================================
# EMAIL CONFIGURATION
# ====================================
SMTP_HOST="smtp.your-provider.com"
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER="your-staging-smtp-user"
SMTP_PASS="your-staging-smtp-password"
FROM_EMAIL="staging-noreply@cosnap.ai"

# ====================================
# FEATURE FLAGS
# ====================================
ENABLE_PAYMENT=true
ENABLE_COMMUNITY=true
ENABLE_LORA_UPLOAD=true
ENABLE_REGION_SWITCH=true
ENABLE_DEBUG_LOGS=true

# ====================================
# DEPLOYMENT CONFIGURATION
# ====================================
DEPLOYMENT_STRATEGY="recreate"
DEPLOYMENT_REPLICAS=1
DEPLOYMENT_MAX_SURGE=1
DEPLOYMENT_MAX_UNAVAILABLE=1