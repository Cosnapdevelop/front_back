# 🌩️ 云存储配置指南

## 📋 支持的云存储服务

- ✅ **阿里云OSS**（推荐）- 国内访问速度快，价格便宜
- ✅ **腾讯云COS** - 备用方案
- ✅ **AWS S3** - 国际化方案

---

## 🔧 阿里云OSS配置（推荐）

### 1. 注册阿里云并开通OSS

1. **访问阿里云官网**: https://www.aliyun.com
2. **注册账号**（需要实名认证）
3. **搜索"对象存储OSS"** → 点击"立即开通"
4. **选择按量付费**（用多少付多少）

### 2. 创建存储桶（Bucket）

1. **进入OSS控制台**
2. **点击"创建Bucket"**
3. **配置信息**：
   - **Bucket名称**: `cosnap-storage`（全球唯一，可自定义）
   - **地域**: 选择离您近的地区（如华东1-杭州）
   - **存储类型**: 标准存储
   - **读写权限**: **公共读**（重要！）
   - **服务端加密**: 无
   - **实时日志查询**: 关闭
   - **传输加速**: 关闭

### 3. 获取访问密钥

1. **鼠标悬停右上角头像** → **AccessKey管理**
2. **创建AccessKey**
3. **记录以下信息**：
   - `AccessKey ID`: LTAI5t...（保密）
   - `AccessKey Secret`: xxxxx...（保密）

### 4. 配置环境变量

在Render控制台添加以下环境变量：

```bash
# 启用阿里云OSS
CLOUD_STORAGE_PROVIDER=aliyun-oss

# 阿里云OSS配置
ALIYUN_OSS_REGION=oss-cn-hangzhou
ALIYUN_OSS_ACCESS_KEY_ID=您的AccessKey_ID
ALIYUN_OSS_ACCESS_KEY_SECRET=您的AccessKey_Secret
ALIYUN_OSS_BUCKET=cosnap-storage

# 可选：CDN加速域名
# ALIYUN_OSS_CUSTOM_DOMAIN=cdn.your-domain.com
```

---

## 💰 费用说明

### 阿里云OSS价格（华东1-杭州）

- **存储费用**: 0.12元/GB/月
- **下行流量**: 0.5元/GB（用户下载图片时）
- **上行流量**: 免费（上传图片）
- **请求费用**: 0.01元/万次

### 预估月费用

**轻度使用**（1000张图片，平均2MB，月访问100次）:
- 存储: 2GB × 0.12元 = 0.24元
- 流量: 0.2GB × 0.5元 = 0.1元
- **总计: 约0.5元/月**

**中度使用**（5000张图片，平均3MB，月访问1000次）:
- 存储: 15GB × 0.12元 = 1.8元
- 流量: 3GB × 0.5元 = 1.5元
- **总计: 约3.5元/月**

---

## 🚀 配置完成后的效果

### ✅ 支持的功能

1. **大文件上传**: 支持最大100MB图片
2. **智能分流**:
   - ≤10MB → RunningHub原生存储
   - >10MB → 自动使用阿里云OSS
3. **CDN加速**: 全球访问加速
4. **高可用性**: 99.9%可用性保证

### 📊 用户体验

- **上传速度**: 根据文件大小自动优化
- **访问速度**: CDN加速，全球快速访问
- **成本控制**: 按实际使用量付费

---

## 🔧 测试配置

配置完成后，您可以：

1. **上传小文件（<10MB）**: 使用RunningHub
2. **上传大文件（>10MB）**: 自动使用阿里云OSS
3. **检查日志**: 查看Render日志确认上传成功

---

## ❓ 常见问题

### Q: 如果不配置云存储会怎样？
A: 系统会自动使用模拟模式，大文件上传会失败，但小文件正常。

### Q: 可以更换其他云存储吗？
A: 可以，修改`CLOUD_STORAGE_PROVIDER`为`tencent-cos`或`aws-s3`即可。

### Q: 如何降低成本？
A: 1) 设置生命周期规则自动删除旧文件 2) 启用CDN缓存 3) 压缩图片后上传

---

**配置完成后，您的Cosnap项目将支持真正的大文件上传功能！** 🎉